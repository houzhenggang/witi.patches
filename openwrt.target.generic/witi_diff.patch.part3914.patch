--- openwrt.bb/openwrt/target/linux/generic/patches-3.10/450-mtd-nand-allow-to-use-platform-specific-chip-fixup.patch	2015-08-15 05:48:44.045131037 +0200
+++ witi-openwrt/target/linux/generic/patches-3.10/450-mtd-nand-allow-to-use-platform-specific-chip-fixup.patch	1970-01-01 01:00:00.000000000 +0100
@@ -1,37 +0,0 @@
----
- drivers/mtd/nand/plat_nand.c |   13 ++++++++++++-
- include/linux/mtd/nand.h     |    1 +
- 2 files changed, 13 insertions(+), 1 deletion(-)
-
---- a/include/linux/mtd/nand.h
-+++ b/include/linux/mtd/nand.h
-@@ -655,6 +655,7 @@ struct platform_nand_chip {
- 	unsigned int options;
- 	unsigned int bbt_options;
- 	const char **part_probe_types;
-+	int (*chip_fixup)(struct mtd_info *mtd);
- };
- 
- /* Keep gcc happy */
---- a/drivers/mtd/nand/plat_nand.c
-+++ b/drivers/mtd/nand/plat_nand.c
-@@ -103,7 +103,18 @@ static int plat_nand_probe(struct platfo
- 	}
- 
- 	/* Scan to find existence of the device */
--	if (nand_scan(&data->mtd, pdata->chip.nr_chips)) {
-+	if (nand_scan_ident(&data->mtd, pdata->chip.nr_chips, NULL)) {
-+		err = -ENXIO;
-+		goto out;
-+	}
-+
-+	if (pdata->chip.chip_fixup) {
-+		err = pdata->chip.chip_fixup(&data->mtd);
-+		if (err)
-+			goto out;
-+	}
-+
-+	if (nand_scan_tail(&data->mtd)) {
- 		err = -ENXIO;
- 		goto out;
- 	}
